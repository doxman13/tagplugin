
var en_language = {
    'appointment_time': 'Appointment Time',
    'google_ads_external_customer_id': 'Google Ads External Customer ID',
    'phone_prefix' : "+84",
};

var en_key_task_searchandreplace = `
    ads_conversion_tracking_troubleshooting:Ads Conversion Tracking Troubleshooting:kiểm tra khắc phục sự cố theo dõi lượt chuyển đổi
    ads_conversion_tracking:Ads Conversion Tracking:triển khai theo dõi lượt chuyển đổi
    ga4_migration:GA4 Migration:triển khai theo dõi số liệu Google Analytics 4
    shopping_onboarding:Shopping Onboarding:triển khai Google Shopping 
    ads_remarketing:Ads Remarketing:triển khai tiếp thị lại
    ads_dynamic_remarketing:Ads Dynamic Remarketing:triển khai tiếp thị lại động
    ads_enhanced_conversions:Ads Enhanced Conversions:triển khai chuyển đổi nâng cao
    ads_website_call_conversion:Ads Website Call Conversion:triển khai lượt chuyển đổi cuộc gọi
    analytics_cross_domain_tracking:Analytics Cross Domain Tracking:phân tích theo dõi tên miền chéo
    analytics_dynamic_remarketing:Analytics Dynamic Remarketing:phân tích tiếp thị lại động 
    analytics_e-commerce_tracking:Analytics E-Commerce Tracking:phân tích theo dõi thương mại điện tử
    analytics_enhanced_e-commerce_tracking:Analytics Enhanced E-Commerce Tracking:phân tích theo dõi thương mại điện tử nâng cao
    analytics_event_tracking:Analytics Event Tracking:theo dõi các sự kiện phân tích
    analytics_health_check:Analytics Health Check:kiểm tra khả năng ghi nhận phân tích
    analytics_remarketing:Analytics Remarketing:phân tích tiếp thị lại
    analytics_setup:Analytics Setup:cài đặt phân tích
    analytics_troubleshooting:Analytics Troubleshooting:kiểm tra khắc phục sự cố phân tích
    consent_mode:Consent Mode:triển khai chế độ đồng ý cho trang web
    fix_sitewide_tagging_ogt_ct:Fix Sitewide Tagging (OGT & CT):sửa lỗi gắn thẻ trên toàn trang web (OGT & CT)
    ga4_e-commerce_migration:GA4 E-Commerce Migration:triển khai theo dõi số liệu mua hàng với Google Analytics 4
    google_tag_manager_installation:Google Tag Manager Installation:cài đặt trình quản lý thẻ cho website
    ads_conversion_code:Ads Conversion Code:triển khai mã nguồn lượt chuyển đổi
    website_call_conversion:Website Call Conversion:triển khai lượt chuyển đổi cuộc gọi cho trang web
    ga_destination_tracking:GA Destination Tracking:triển khai theo dõi trang đích với Google Analytics
    ga_event_tracking:GA Event Tracking:triển khai theo dõi sự kiện Google Analytics
    ga_smart_goals:GA Smart Goals:triển khai mục tiêu thông minh với Google Analytics
    site_wide_tag_-_conversion_tracking_fix(ogt_&_ct):Site Wide Tag - Conversion Tracking Fix(OGT & CT):sửa lỗi gắn thẻ và lượt chuyển đổi trên toàn trang web (OGT & CT)
    dynamic_remarketing_retail:Dynamic Remarketing - Retail:triển khai tiếp thị lại động - retail (bán lẻ)
    dynamic_remarketing_x_non_retail:Dynamic Remarketing - X (Non-Retail):triển khai tiếp thị lại động - X (Non-Retail)
    google_analytics_dynamic_remarketing_non_retail:Google Analytics Dynamic Remarketing (Non-Retail):triển khai tiếp thị lại động trên Google Analytics (Non-Retail)
    google_analytics_dynamic_remarketing_retail:Google Analytics Dynamic Remarketing (Retail):triển khai tiếp thị lại động trên Google Analytics - X (Non-Retail)
    google_analytics_health_check:Google Analytics Health Check:triển khai kiểm tra khả năng ghi nhận của Google Analytics 
    ga_starter_pack:GA Starter Pack:làm quen với Google Analytics
    google_analytics_troubleshooting:Google Analytics Troubleshooting:kiểm tra khắc phục sự cố Google Analytics
    offline_conversion_tracking:Offline Conversion Tracking:triển khai chuyển đổi theo dõi ngoại tuyến
    recaptcha_implementation:ReCaptcha Implementation:triển khai ReCaptcha
    cross_domain_tracking:Cross Domain Tracking:triển khai theo dõi tên miền chéo
    lead_form_ad_extension:Lead Form Ad Extension:triển khai tiện ích mở rộng biểu mẫu khách hàng tiềm năng
    enhanced_conversions:Enhanced Conversions:triển khai chuyển đổi nâng cao
    shopping_feed_optimization:Shopping Feed Optimization:tối ưu nguồn cấp dữ liệu trên Google Shopping
`;

var en_heading_searchandreplace = `
    Good news, the Technical Solutions Team has received your case
    Good news, the Technical Solutions Team has received your case
    Here's the latest update regarding your case:Here's the latest update regarding your case
    Your appointment has been successfully rescheduled:Your appointment has been successfully rescheduled:
    Your appointment has been successfully rescheduled:Your appointment has been successfully rescheduled
    Congratulations, your case has been successfully implemented:Congratulations, your case has been successfully implemented
    Your case has been successfully implemented:Your case has been successfully implemented
    Congratulations on implementing your case:Congratulations on implementing your case
    Your case has been successfully implemented:Your case has been successfully implemented
    More information is needed to complete your implementation:More information is needed to complete your implementation
    Your case is in consultation:Your case is in consultation
    Your case status has been updated:Your case status has been updated
    We tried to reach you today regarding your case:We tried to reach you today regarding your case
    Please provide additional details for your case:Please provide additional details for your case
    Your case cannot be completed due to technical issues:Your case cannot be completed due to technical issues
    Your case has been closed due to inactivity:Your case has been closed due to inactivity
    Your case has been closed:Your case has been closed
    Your case is not ready for implementation. Learn more:Your case is not ready for implementation. Learn more
    Your case has been rerouted to the correct support team:Your case has been rerouted to the correct support team
    We are working to reroute your case to the correct support team:We are working to reroute your case to the correct support team
    Your request is out of scope for the Technical Solutions Team:Your request is out of scope for the Technical Solutions Team
    Your case will be closed. Learn more:Your case will be closed. Learn more
`;

var en_hotkey_email = {
    'ts as new':'Good news, the Technical Solutions Team has received your case',
    'ts as wip offtfr':'Good news, the Technical Solutions Team has received your case',
    'ts as wip offs':"Technical Solutions Team - Here's the latest update regarding your case",
    'ts as resched1':'Technical Solutions Team - Your appointment has been successfully rescheduled',
    'ts as reschedok':'Technical Solutions Team - Your appointment has been rescheduled',
    'ts so verif':'Congratulations, your case has been successfully implemented',
    'ts so verif nrc':'Congratulations, your case has been successfully implemented',
    'ts so unv':'Congratulations on implementing your case',
    'ts so vnn':'Congratulations, your case has been successfully implemented',
    'ts ni ai':'Technical Solutions Team - Your case status has been updated',
    'ts ni ic':'Technical Solutions Team - Your case is in consultation',
    'ts ni av':'Technical Solutions Team - Your case status has been updated',
    'ts ni ac':'Technical Solutions Team - We tried to reach you today regarding your case',
    'ts ni oth':'Technical Solutions Team - Your case will be closed',
    'ts in inf':'Technical Solutions Team - Your case cannot be completed due to technical issues',
    'ts in nrch':'Technical Solutions Team - Your case has been closed due to inactivity',
    'ts in ni':'Technical Solutions Team - Your case has been closed',
    'ts in nrdy':'Technical Solutions Team - Your case is not ready for implementation',
    'ts in oost':'Technical Solutions Team - Your case has been rerouted to the correct support team',
    'ts in oosu':'Technical Solutions Team - We are working to reroute your case to the correct support team',
    'ts in oos seller':'TTechnical Solutions Team - Your request is out of scope for the Technical Solutions Team',
    'ts in oth':'Technical Solutions Team - Your case will be closed',
};

var en_searchandremove = [
    'Technical Solutions Team',
];

var en_api_blog = 'https://cdtx.lyl.vn/cdtx-assistant/filemanager_api/api.php';




var en_checkStyleByTheme = (opt_isdisable) => {
    if(opt_isdisable) return false;


    var _timekey_current = new Date().getDate();
    // var _timekey_current = new Date().getDate() + "" + new Date().getMinutes();
    var _key = "cdtx_stylecasebytheme";

    var _sync_api = (_objectvalue) => {
        var _body = {
            "action": "stylecasebytheme",
            "language": "en",
            "timesync": _timekey_current
        };
        load_fetch_post_content(en_api_blog, _body, (response_api) => {
            if(response_api.rs) {
                setChromeStorage(_key, response_api , () => {
                    var cdtx_panel_div_style = _TrustScript(response_api.style_str);
                    document.body.insertAdjacentHTML("afterEnd", cdtx_panel_div_style);
                });
            } 
        });
    }
    
    getChromeStorage(_key, (response) => {
        var _objectvalue = {};
        if(response.value) {
            _objectvalue = response.value;
            cLog(() => {console.log("===", _objectvalue)})
            if(_objectvalue.timesync == _timekey_current) {
                cLog(() => {console.log("CACHE ===== STYLE")})
                var cdtx_panel_div_style = _TrustScript(_objectvalue.style_str);
                document.body.insertAdjacentHTML("afterEnd", cdtx_panel_div_style);
            } else {
                // Sync API
                _sync_api(_objectvalue)
            }
        } else {
            cLog(() => {console.log("FIRST TIME => FETCH API")})
            // Sync API
            _sync_api(_objectvalue);
        }
    });
}

var en_clearAndPrepareCRTemplate = () => {
    // Prepare
    var _composeemailcard = document.querySelector('.write-cards-wrapper:not([style*="display:none"]):not([style*="display: none"]) card.write-card.is-top[card-type="compose"]');
    if(_composeemailcard) {
        cLog(()=>{console.log("CR -> Start")});
        var _email_body_content = _composeemailcard.querySelector('#email-body-content');
        _email_body_content.style.padding = '0px';
        _email_body_content.style.width = '100%';

        var _email_body_content_top = _composeemailcard.querySelector('#email-body-content-top');
        _email_body_content_top.innerHTML = '<div id="email-body-content-top-content"><p dir="auto"></p></div>';

        var _email_body_content_top_content = _composeemailcard.querySelector('#email-body-content-top-content');
        
        
        _email_body_content_top_content.innerHTML = '<p dir="auto"><br></p>';
        
        var ntime = 0;
        var myInterval = setInterval(() => {
            cLog(()=>{console.log("CR -> interval focus cursor point and check content")});

            addCursor2Contenteditable(_email_body_content_top_content);

            if(_email_body_content_top_content.innerText.trim().length > 0) {
                clearInterval(myInterval);

                // replace heading search td table and replace heading
                var _tdcellist = _email_body_content_top_content.querySelectorAll("td");
                if(_tdcellist.length) {
                    _tdcellist.forEach((item) => {
                        var _heading = item.innerText.trim();
                        var _getvalue = searchAndReturnValue(en_heading_searchandreplace, _heading, 1);
                        if(_getvalue) {
                            item.innerText = _getvalue;
                        }
                    });
                }

                // replace heading search td table and replace heading
                var _tdcellist = _email_body_content_top_content.querySelectorAll(".replaced");
                if(_tdcellist.length) {
                    _tdcellist.forEach((item) => {
                        var _heading = item.innerText.trim();
                        var _list = ['']
                        var _getvalue = searchAndReturnValue(en_key_task_searchandreplace, _heading, 1);
                        if(_getvalue) {
                            item.innerText = _getvalue;
                        }
                    })
                }

                // remove text
                var _tr = _email_body_content_top_content.querySelectorAll("tr");
                if(_tr.length) {
                    _tr.forEach((item) => {
                        var _text = item.innerText.trim();
                        en_searchandremove.forEach((item2) => {
                            if(_text == item2) {
                                item.remove();
                            }
                        })
                    })
                }


                // Update action
                _email_body_content_top_content.dispatchEvent(new Event('input'));
                _email_body_content_top_content.dispatchEvent(new Event('focus'));
                _email_body_content_top_content.dispatchEvent(new Event('click'));
                _email_body_content_top_content.click();
                document.execCommand("insertText", false, " ");
            }

            // more than 10s
            if(ntime > 10) {
                cLog(()=>{console.log("CR -> Clear time more than 10s")});
                clearInterval(myInterval);
            }
            ntime++;
            
            
        }, 1000);
    }
}

